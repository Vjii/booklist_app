<% include ../partials/header %>

	<section>
		<div class="grid__row  profile__container--shape-circular">
			<div class="col profile--shape-circular profile--theme-dark">
					<h3 class="profile__name profile__name--align-center"><%= collection.author.username %></h3>

			</div>
		</div>

		<div class="grid__row profile--theme-dark">
			<div class="col ">
				<div class="image__container image__container--size-small ">
					<img class="image image_rounded" src="<%= collection.author.image %>">

					<% if (currentUser && collection.author.id.equals(currentUser._id)) { %>
					<a href="/collections/<%= collection._id%>/books/new">
					<p><button class="button button__full vertical_margin-small">Add a new book</button>
					</p>
					</a>
					<% } %>
				</div>
			</div>


			<div class="col profile--theme-dark">
				<div class="profile__body">
					<h1 class="heading__title heading_margin-small">My list of ideas - <%= collection.title%></h1>
					<p class="paragraph">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
				</div>
			</div>
		</div>

	</section>


	<section class="book__container">
	<% collection.books.forEach(function(book) { %>
		<div class="grid__row book">
				<div class="col book__presentation">
					<h2 class="heading_margin-small heading__title"><%= book.title %></h2>
					<div class="image__container image__container--thin-center">
						<img class="image image--width-thin book__image image_rounded" src="<%= book.image %>">
					</div>

				</div>

			<div class="col book__body">
				<% if (book.ideas) { %>
					<% book.ideas.forEach(function(idea) {%>
						<div class="book__ideas">
							<h3 class="heading__title vertical_margin-small"><%= idea.name%></h3>
							<p class="vertical_margin-small text_justified"><%= idea.description%></p>

							<% if (currentUser && collection.author.id.equals(currentUser._id)) { %>
								<div class="button__container">
									<a class="button--horizontal" href="/collections/<%= collection._id %>/books/<%= book._id%>/ideas/<%= idea._id%>/edit">
									<button class="button button__edit button_margin-horizontal button_margin-vertical">Edit idea
									</button>
									</a>
									<form class="button--horizontal" action="/collections/<%= collection._id%>/books/<%= book._id%>/ideas/<%= idea._id%>?_method=DELETE" method="POST">
										<button class="button button__delete button_margin-vertical">Delete idea
										</button>
									</form>
								</div>
							<% } %>

						</div>
					<% }) %>
				<% } %>


				<% if (currentUser && collection.author.id.equals(currentUser._id)) { %>
					<div class="book__buttons">
						<a class="button--horizontal" href="/collections/<%= collection._id%>/books/<%= book._id%>/ideas/new">
							<button class="button button__edit button_margin-horizontal button_margin-vertical">Add ideas</button>
						</a>
						<a class="button--horizontal" href="/collections/<%= collection._id%>/books/<%= book._id%>/edit">
							<button class="button button__edit button--horizontal button_margin-horizontal button_margin-vertical">Edit book</button>
						</a>
						<form class="button--horizontal" action="/collections/<%= collection._id%>/books/<%= book._id%>?_method=DELETE" method="POST">
							<button class="button button__delete button_margin-vertical">Delete</button>
						</form>
					</div>
				<% } %>
			</div>

		</div>
	<% }); %>
	</section>

	<div class="grid__row comment__title">
		<div class="col">
			<h1 class="heading__title">Comment</h1>
		</div>
	</div>

	<% collection.comments.forEach(function(comment) { %>
		<div class="grid__row comment">
			<div class="">
				<div class="col profile__presentation profile__presentation--theme-light">
					<div class="image__container image__container--size-thumbnail">
						<img class="image image_rounded" src="<%= comment.author.image%>">
					</div>
					<h3 class="profile__name"><%= comment.author.username%></h3>
				</div>
			</div>

			<div class="col comment__comment">
				<div class="col comment__date">
					<p class="paragraph">Posted on
					<%= comment.date.toUTCString() %>
					</p>
				</div>
				<p class="comment__comment"><%= comment.text%></p>
				<% if (currentUser && collection.author.id.equals(currentUser._id)) { %>
					<div class="comment__buttons">
						<a href="/collections/<%= collection._id%>/comment/<%= comment._id%>/edit">
						<button class="button button__edit button_margin-horizontal">Edit</button>
						</a>
						<form action="/collections/<%= collection._id%>/comment/<%= comment._id%>?_method=DELETE" method="POST">
							<button class="button button__delete ">Delete</button>
						</form>
					</div>
				<% } %>
			</div>
		</div>
	<% })%>
</div>

<% include ../partials/footer %>



